<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" nameag="viewport"/>
<title>Hematology Clinical Vignettes</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<style>
        /* Custom styles for enhanced aesthetics and responsiveness */
        .option-btn {
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .option-btn:hover, .option-btn:active {
            transform: scale(1.02);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .option-btn.selected {
            background-color: #3b82f6;
            color: white;
        }
        .marked {
            background-color: #fef08a;
        }
        .progress-bar {
            transition: width 0.5s ease-in-out;
            background: linear-gradient(to right, #3b82f6, #22c55e);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        .question-nav-btn, .result-nav-btn-grid {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 16px;
            touch-action: manipulation;
            transition: all 0.2s ease;
        }
        .question-nav-btn:hover, .question-nav-btn:active, .result-nav-btn-grid:hover, .result-nav-btn-grid:active {
            transform: scale(1.05);
        }
        .answered {
            background-color: #22c55e;
            color: white;
        }
        .unanswered {
            background-color: #e5e7eb;
        }
        .marked-nav {
            border: 2px solid #fef08a;
        }
        .video-container, .audio-container {
            display: none;
            position: relative;
        }
        .video-container.active, .audio-container.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .section-transition {
            transition: opacity 0.3s ease;
        }
        .section-transition.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .result-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }
        .result-nav-btn {
            background-color: #4b5563;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.2s ease;
        }
        .result-nav-btn:hover, .result-nav-btn:active {
            background-color: #374151;
            transform: scale(1.05);
        }
        .result-nav-btn:disabled {
            background-color: #d1d5db;
            cursor: not-allowed;
        }
        .error-message {
            color: #dc2626;
            font-weight: bold;
            margin-top: 1rem;
        }
        /* Mobile-specific adjustments */
        @media (max-width: 640px) {
            .question-nav-btn, .result-nav-btn-grid {
                width: 38px;
                height: 38px;
                font-size: 14px;
            }
            .nav-panel, .results-nav-panel {
                width: 100%;
                max-width: 100%;
                overscroll-behavior: contain;
            }
            .option-btn {
                padding: 12px;
                font-size: 14px;
            }
            .header-text {
                font-size: 1.5rem;
            }
            .subheader-text {
                font-size: 0.875rem;
            }
            .button-group, .result-nav {
                flex-direction: column;
                gap: 0.5rem;
            }
            .result-nav-btn {
                width: 100%;
                text-align: center;
            }
        }
        /* Dark mode styles */
        .dark .bg-gray-100 {
            background-color: #1f2937;
        }
        .dark .bg-white {
            background-color: #374151;
        }
        .dark .text-gray-700 {
            color: #d1d5db;
        }
        .dark .text-gray-800 {
            color: #e5e7eb;
        }
        .dark .bg-gray-200 {
            background-color: #4b5563;
        }
        .dark .border {
            border-color: #4b5563;
        }
        .dark .bg-blue-500 {
            background-color: #2563eb;
        }
        .dark .hover\:bg-blue-600:hover {
            background-color: #1d4ed8;
        }
        .dark .bg-yellow-300 {
            background-color: #b45309;
            color: white;
        }
        .dark .hover\:bg-yellow-400:hover {
            background-color: #92400e;
        }
        .dark .bg-green-500 {
            background-color: #15803d;
        }
        .dark .hover\:bg-green-600:hover {
            background-color: #166534;
        }
        .dark .bg-gray-500 {
            background-color: #4b5563;
        }
        .dark .hover\:bg-gray-600:hover {
            background-color: #374151;
        }
        .dark .result-nav-btn, .dark .result-nav-btn-grid {
            background-color: #2563eb;
        }
        .dark .result-nav-btn:hover, .dark .result-nav-btn:active, .dark .result-nav-btn-grid:hover, .dark .result-nav-btn-grid:active {
            background-color: #1d4ed8;
        }
        .dark .result-nav-btn:disabled, .dark .result-nav-btn-grid:disabled {
            background-color: #4b5563;
        }
        .video-placeholder {
            width: 400px;
            height: 300px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-top: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
        }
        .play-icon {
            font-size: 40px;
            color: #007bff;
        }
        .video-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
    </style>

<script>
    // --- GEMINI AUTO-CAPTURE LISTENER ---
    // This function runs immediately after the quiz determines an answer is INCORRECT.
    function captureMistake(questionIndex, questionsData) {
        try {
            const item = questionsData[questionIndex];
            // Use the question text as a unique, stable identifier
            const uniqueId = 'srs_quiz_' + btoa(item.text.substring(0, 50)).replace(/=/g, ''); 

            // 1. Clean and simplify the explanation for storage
            let explanationText = item.explanation || item.correct_answer || "No explanation provided.";
            
            // Strip complex HTML (images, lists) and boilerplate text
            explanationText = explanationText.replace(/<img[^>]*>/g, "[IMAGE]").trim(); // Replace images with placeholder
            explanationText = explanationText.replace(/<p><strong>Ans\. [A-Z]\).*/i, "").trim(); // Remove the repeated Answer line
            explanationText = explanationText.replace(/<p><strong>Educational Objective:<\/strong>.*?<\/p>/gs, "").trim(); // Remove EO block
            explanationText = explanationText.replace(/@dams_new_robot/g, "");
            explanationText = explanationText.replace(/<\/?[^>]+(>|$)/g, " ").trim(); // Final strip of remaining tags

            // 2. Prepare card data
            const cardData = {
                text: item.text,
                answer: item.correct_answer,
                explanation: explanationText.substring(0, 500), // Keep explanations short
                nextReview: 0, // Due immediately
                reviews: 0,
                source: document.title.split('-')[0].trim() || 'Quiz'
            };

            // 3. Save to Local Storage (SRS Bank)
            localStorage.setItem(uniqueId, JSON.stringify(cardData));
            
            console.log(`ðŸ§  Captured Mistake #${questionIndex + 1} from ${document.title}`);

        } catch (e) {
            console.error("SRS Capture Failed:", e);
        }
    }
    // --- END GEMINI AUTO-CAPTURE LISTENER ---
</script>

</head>
<body class="bg-gray-100 font-sans transition-colors duration-300 min-h-screen overflow-y-auto">
<!-- Header Section -->
<header class="bg-blue-600 text-white p-4 shadow-lg">
<div class="container mx-auto">
<h1 class="text-2xl md:text-3xl font-bold header-text">Hematology Clinical Vignettes</h1>
<p class="mt-2 text-sm md:text-base subheader-text">
                25 Questions | 100 Total Marks | 35 min Duration | ~84.0 sec/question
            </p>
<button class="mt-2 bg-gray-200 text-gray-800 px-3 py-1 rounded-lg hover:bg-gray-300 transition dark:bg-gray-600 dark:text-white" id="theme-toggle">
                Toggle Dark Mode
            </button>
</div>
</header>
<!-- Instructions Section -->
<section class="container mx-auto p-4 md:p-6 section-transition" id="instructions">
<div class="bg-white rounded-lg shadow-md p-5 md:p-8 md:p-5 md:p-8 min-h-screen md:min-h-0 md:rounded-lg md:shadow-md rounded-none shadow-none flex flex-col justify-between">
<h2 class="text-xl font-semibold mb-4">Instructions</h2>
<ul class="list-disc list-inside space-y-2 text-gray-700">
<li>This test contains 25 multiple choice questions.</li>
<li>Each question has only one correct answer.</li>
<li>You will have 35 minutes to complete the test.</li>
<li>Click or tap on an option to select your answer.</li>
<li>Use the "Mark for Review" button to revisit questions.</li>
<li>Navigate using Previous/Next buttons or the Questions Navigation panel.</li>
<li>Click "Submit" to finish and view results.</li>
<li>The test will auto-submit when time runs out.</li>
</ul>
<div class="mt-6 flex space-x-4 button-group md:flex-row flex-col">
<button class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition" id="start-test">Start Test</button>


</div>
<div class="error-message hidden" id="error-message"></div>
</div>
</section>
<!-- Quiz Section -->
<section class="container mx-auto p-4 md:p-6 hidden section-transition" id="quiz">
<div class="bg-white rounded-lg shadow-md p-5 md:p-8 md:p-5 md:p-8 min-h-screen md:min-h-0 md:rounded-lg md:shadow-md rounded-none shadow-none flex flex-col justify-between">
<!-- Progress Bar -->
<div class="w-full bg-gray-200 rounded-full h-3 mb-4">
<div class="progress-bar h-3 rounded-full" id="progress-bar" style="width: 0%"></div>
</div>
<!-- Question Header -->
<div class="flex flex-col md:flex-row justify-between items-center mb-4">
<h2 class="text-lg font-semibold" id="question-number">Question <span>1</span> of 25</h2>
<p class="text-lg font-semibold mt-2 md:mt-0" id="timer">Time Remaining: <span>00:00</span></p>
</div>
<!-- Question Content -->
<div class="mb-6" id="question-content">
<p class="text-gray-800 mb-4" id="question-text"></p>
<div class="flex flex-wrap gap-4 mb-4" id="question-images"></div>
<div class="space-y-3" id="options"></div>
</div>
<!-- Navigation Buttons -->
<div class="flex flex-col md:flex-row justify-between items-center gap-2 md:gap-4">
<button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition w-full md:w-auto" disabled="" id="previous-btn">Previous</button>
<button class="bg-yellow-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-yellow-400 transition w-full md:w-auto" id="mark-review">Mark for Review</button>
<button class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition w-full md:w-auto" id="next-btn">Next</button>
<button class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full md:w-auto" id="nav-toggle">Questions Navigation</button>
<button class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition w-full md:w-auto" id="submit-test">Submit Test</button>
</div>
</div>
</section>
<!-- Results Section -->
<section class="container mx-auto p-4 md:p-6 hidden section-transition" id="results">
<div class="bg-white rounded-lg shadow-md p-5 md:p-8 md:p-5 md:p-8 min-h-screen md:min-h-0 md:rounded-lg md:shadow-md rounded-none shadow-none flex flex-col justify-between">
<h2 class="text-2xl font-semibold mb-4">Hematology Clinical Vignettes - Results</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
<p><strong>Correct:</strong> <span id="correct-count">0</span></p>
<p><strong>Wrong:</strong> <span id="wrong-count">0</span></p>
<p><strong>Unanswered:</strong> <span id="unanswered-count">0</span></p>
<p><strong>Marked for Review:</strong> <span id="marked-count">0</span></p>
</div>
<h3 class="text-lg font-semibold mb-4" id="result-question-number">Question <span>1</span> of 25</h3>
<div class="space-y-6" id="results-content"></div>
<div class="result-nav">
<button aria-label="Previous question result" class="result-nav-btn" disabled="" id="prev-result">Previous</button>
<button aria-label="Toggle results navigation panel" class="result-nav-btn" id="results-nav-toggle">Results Navigation</button>
<button aria-label="Next question result" class="result-nav-btn" id="next-result">Next</button>
</div>
<div class="mt-6 flex space-x-4 button-group md:flex-row flex-col">
<button class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition" id="take-again">Take Again</button>
<button class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition" id="review-test">Review Test</button>
</div>
</div>
</section>
<!-- Exit Confirmation Modal -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" id="exit-modal">
<div class="bg-white rounded-lg p-6 max-w-sm w-full">
<h2 class="text-xl font-semibold mb-4">Leave Test?</h2>
<p class="text-gray-700 mb-4">Your progress will be lost if you leave this page. Are you sure you want to exit?</p>
<div class="flex justify-end space-x-4">
<button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition" id="continue-test">No, Continue</button>
<button class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition" id="exit-test">Yes, Exit</button>
</div>
</div>
</div>
<!-- Submit Confirmation Modal -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" id="submit-modal">
<div class="bg-white rounded-lg p-6 max-w-sm w-full">
<h2 class="text-xl font-semibold mb-4">Confirm Submission</h2>
<p class="text-gray-700 mb-2">You have attempted <span id="attempted-count">0</span> of 25 questions.</p>
<p class="text-gray-700 mb-4"><span id="unattempted-count">0</span> questions are unattempted.</p>
<div class="flex justify-end space-x-4">
<button class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition" id="cancel-submit">Cancel</button>
<button class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition" id="confirm-submit">Submit Test</button>
</div>
</div>
</div>
<!-- Quiz Navigation Panel -->
<div class="fixed inset-y-0 right-0 nav-panel bg-white shadow-lg p-4 hidden overflow-y-auto" id="nav-panel">
<h2 class="text-lg font-semibold mb-4">Questions Navigation</h2>
<div class="mb-4">
<select class="w-full p-2 border rounded-lg text-gray-700" id="nav-filter">
<option value="all">All Questions</option>
<option value="answered">Answered</option>
<option value="unanswered">Unanswered</option>
<option value="marked">Marked for Review</option>
</select>
</div>
<div class="grid grid-cols-5 gap-2 md:gap-3" id="nav-grid"></div>
<button class="mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full" id="close-nav">Close</button>
</div>
<!-- Results Navigation Panel -->
<div class="fixed inset-y-0 right-0 results-nav-panel bg-white shadow-lg p-4 hidden overflow-y-auto" id="results-nav-panel">
<h2 class="text-lg font-semibold mb-4">Results Navigation</h2>
<div class="mb-4">
<select class="w-full p-2 border rounded-lg text-gray-700" id="results-nav-filter">
<option value="all">All Questions</option>
<option value="answered">Answered</option>
<option value="unanswered">Unanswered</option>
<option value="marked">Marked for Review</option>
</select>
</div>
<div class="grid grid-cols-5 gap-2 md:gap-3" id="results-nav-grid"></div>
<button class="mt-4 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition w-full" id="close-results-nav">Close</button>
</div>
<!-- JavaScript Logic -->
<script>
        // Enable debug mode for detailed logging
        const DEBUG_MODE = true;

        // Log debug messages
        function debugLog(message) {
            if (DEBUG_MODE) {
                console.log(`[DEBUG] ${message}`);
            }
        }

        // Initialize questions with error handling
        let questions = [];
        let currentResultQuestion = 0; // State for current question in results
        try {
            debugLog("Attempting to parse questions_json");
            questions = [{"text": "A 30-year-old woman presented with several weeks of increasing tiredness and fatigue. She feels worse after walking up stairs and symptoms improves with rest. Her menstrual periods last 5 days and are regular. On Examination: Respiratory rate: 16 breaths/minute; BP: 110/70 mm Hg; Pulse: 88 beats/minute; Pallor +, General appearance: normal Cardiovascular: normal Chest: clear to auscultation. Thyroid function: normal Oximeter: 98% CBC: Haematocrit: 28%, Haemoglobin: 9 g/dL Mean corpuscular volume (MCV): 74 fL ,White blood cells (WBCs): 7000/Î¼L Platelets: 378,000/Î¼L. Which of these does not cause this patientâ€™s type of anemia?", "options": [{"label": "A", "text": "Sideroblastic", "correct": false}, {"label": "B", "text": "Folic acid deficiency", "correct": true}, {"label": "C", "text": "Iron deficiency", "correct": false}, {"label": "D", "text": "Chronic disease", "correct": false}], "correct_answer": "B. Folic acid deficiency", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/73133361698816971/73133361698816971.m3u8"}, {"text": "A 40 year old male presented with dyspnea on exertion. He also c/o black coloured stools intermittently. There is no weight loss. He doesnâ€™t take alcohol or smoke. There is no significant past medical history. On examination pallor is present. Respiratory, CVS and abdomen examination are normal. On Lab test- CBC: Hematocrit: 23% Hemoglobin: 7 g/dL MCV: 70 fL WBCs: 7,400/ÂµL Platelets: 588,000/ÂµL Iron: low TIBC: elevated Ferritin level: low Reticulocyte count: 1% Peripheral smear: microcytic, hypochromic cells; no target cells; no schistocytes or fragmented cells Red blood cell distribution width (RDW): elevated. Which of the following investigations will be important for him", "options": [{"label": "A", "text": "Upper GI endoscopy", "correct": true}, {"label": "B", "text": "Bone marrow biopsy", "correct": false}, {"label": "C", "text": "Serum B12 levels", "correct": false}, {"label": "D", "text": "Serum copper", "correct": false}], "correct_answer": "A. Upper GI endoscopy", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/65260131698816987/65260131698816987.m3u8"}, {"text": "A 25 year old female diagnosed a case of iron deficiency anemia and was started on oral iron replacement. She is compliant with iron tablets. But there was no improvement in symptoms even after one month of treatment. The repeat hematocrit test shows that the level rose from 23% to 25%. The reticulocyte count rises only from 1% to 2.5%.Hb remains at pre treatment value of 8.0 gm/dl. You suspect that there is defect in iron absorption. Which of the following substances may be impeding the absorption of iron?", "options": [{"label": "A", "text": "Cimetidine", "correct": true}, {"label": "B", "text": "Vitamin C", "correct": false}, {"label": "C", "text": "Vitamin D", "correct": false}, {"label": "D", "text": "Carbonated beverages", "correct": false}], "correct_answer": "A. Cimetidine", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/25468161698817124/25468161698817124.m3u8"}, {"text": "A 28-year-old woman comes for preemployment screening tests prior to her first job. She is asymptomatic. She has never had a blood tests done earlier. There is no previous medical history. Her menstrual blood flow is normal. On further evaluation of family history, Her brother has low Hb. Hematocrit: 28% Hemoglobin: 10 g/dL MCV: 65 fL Smear: target cells. Which is most likely to be found in this patient?", "options": [{"label": "A", "text": "RBC count is elevated.", "correct": true}, {"label": "B", "text": "Platelet count is elevated", "correct": false}, {"label": "C", "text": "TIBC is elevated.", "correct": false}, {"label": "D", "text": "Iron level is low.", "correct": false}], "correct_answer": "A. RBC count is elevated.", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/68386111698817157/68386111698817157.m3u8"}, {"text": "A 45 year old male started on ATT for pulmonary tuberculosis. He is regular with medicines and now has completed 5 months. Presently on 2 drugs ATT. He c/o dyspnea on exertion with easy fatique, though his symptoms of tuberculosis(fever, cough and loss of appetite) has improved. His lab tests shows hb-9 g/dl. Iron studies were done which shows high serum iron with normal ferritin and TIBC. What is the likely cause of this anemia?", "options": [{"label": "A", "text": "Anemia of chronic disease", "correct": false}, {"label": "B", "text": "INH induced", "correct": true}, {"label": "C", "text": "Iron deficiency", "correct": false}, {"label": "D", "text": "Thalassemia", "correct": false}], "correct_answer": "B. INH induced", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/48313271698817173/48313271698817173.m3u8"}, {"text": "A 78-year-old man comes to OPD with several weeks of progressive weakness and fatigue. Over the last 1 to 2 weeks, he has developed a tingling sensation in his feet. Past medical h/o- Hypertension and Diabetes. He is consuming alcohol 200 ml/day for last 40 years. Current Medications: Enalapril and Metformin. Physical Examination: pallor +, icterus +, Cardiovascular: 2/6 murmur at apex radiating to axilla Chest: clear. Neurological: decreased sensation symmetrically over the lower extremities bilaterally; normal position and vibratory sensation. On Lab tests-Hb 9.5 g/dl, MCV: 118 fL WBCs: 2800/ÂµL Platelets: 110,000/ÂµL Vitamin B12 level: borderline low, Folate: normal, fasting plasma Glucose: 185 mg/dL HbA1c: 8.5%.What can be the cause of patientâ€™s symptoms?", "options": [{"label": "A", "text": "Alcohol", "correct": false}, {"label": "B", "text": "Diabetes", "correct": false}, {"label": "C", "text": "Metformin use", "correct": false}, {"label": "D", "text": "All", "correct": true}], "correct_answer": "D. All", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/73473611698817209/73473611698817209.m3u8"}, {"text": "A 50 year old female with type 2 diabetes on metformin for 10 years presented with fatique. On examination pallor is present. Lab tests revealed Hb-9.0 g/dl, P/S- hypersegmented neutrophils with macrocytes. You are suspecting that metformin is causing vitamin B 12 deficiency. What test should be done to confirm the presence of vitamin B12 deficiency?", "options": [{"label": "A", "text": "Methylmalonic acid level", "correct": true}, {"label": "B", "text": "Anti-intrinsic factor/antiparietal cell antibodies", "correct": false}, {"label": "C", "text": "Schilling test", "correct": false}, {"label": "D", "text": "Homocysteine level", "correct": false}], "correct_answer": "A. Methylmalonic acid level", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/42408321698817788/42408321698817788.m3u8"}, {"text": "In previous clinical case Vitamin B12 is given orally. Two weeks later, laboratory test results show an elevated lactate dehydrogenase and indirect bilirubin and there is no improvement in patient symptoms. The peripheral smear still shows hypersegmented neutrophils and reticulocyte count remained 1%. What will be your next step", "options": [{"label": "A", "text": "Wait for 2 more weeks and continue with oral vitamin B12", "correct": false}, {"label": "B", "text": "Increase the dose of oral vitamin b12", "correct": false}, {"label": "C", "text": "Shift to injectable vitamin B12", "correct": true}, {"label": "D", "text": "Add folic acid also", "correct": false}], "correct_answer": "C. Shift to injectable vitamin B12", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/17483551698817807/17483551698817807.m3u8"}, {"text": "A 60 year old male patient presented with dyspnoea on exertion with difficulty in walking. There is past history of surgery where some part of his small intestine removed. On examination-pallor is present, CVS/respiratory system normal. CNS-decreased deep tendon reflex. Lab tests showed Hb-8.8%,macrocytosis on peripheral smear, serum vitamin B12 are low. You start patient on intramuscular injection of B12. What should you test for immediately after replacement?", "options": [{"label": "A", "text": "Hb", "correct": false}, {"label": "B", "text": "Calcium level", "correct": false}, {"label": "C", "text": "LDH and bilirubin", "correct": false}, {"label": "D", "text": "Potassium level", "correct": true}], "correct_answer": "D. Potassium level", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/47299241698817834/47299241698817834.m3u8"}, {"text": "A 28-year-old man with a history of sickle cell disease arrives at the emergency with recurrence of a pain crisis. He c/o pain in leg and chest. This is the same as his usual crisis. He has been noncompliant with hydroxyurea. Besides pain, he has had fever. Past medical h/o: Gallstones Osteomyelitis, Skin ulcers, Pneumonia and Priapism episode in past. On examination Respiratory rate: 28 breaths/minute; BP: 150/88 mm Hg; P: 120 beats/minute; T: 102 Â°F. What is the most important step at this time?", "options": [{"label": "A", "text": "Restart hydroxyurea", "correct": false}, {"label": "B", "text": "Draw blood cultures and start antibiotics.", "correct": true}, {"label": "C", "text": "Surgery referral for gall bladder stone", "correct": false}, {"label": "D", "text": "Obtain old records to confirm sickle cell disease in this patient.", "correct": false}], "correct_answer": "B. Draw blood cultures and start antibiotics.", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/70052891698817857/70052891698817857.m3u8"}, {"text": "A 30 year old male known case of sickle cell disease presented with chest pain, restlessness and dyspnea. He also c/o priapism. He is irregular with his prescribed medicines. He also c/o fever for 2 days. His oxygen saturation is 90%. Peripheral smear is done as shown in figure. You admit the patient. Despite giving oxygen, ceftriaxone and hydration, the patientâ€™s chest pain and hypoxia worsen. What is the next step?", "options": [{"label": "A", "text": "Change antibiotics.", "correct": false}, {"label": "B", "text": "Provide continuous positive airway pressure.", "correct": false}, {"label": "C", "text": "Perform exchange transfusion.", "correct": true}, {"label": "D", "text": "Increase IV fluids", "correct": false}], "correct_answer": "C. Perform exchange transfusion.", "question_images": ["https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/11(199).jpg"], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/1084291698817912/1084291698817912.m3u8"}, {"text": "A 43-year-old woman recently treated for a dental abscess with amoxicillin presents to the emergency department with 2 days of progressively worsening weakness, fatigue, and yellow skin. She says that her friends told her that her eyes have turned yellow. On examination respiratory rate: 22 breaths/minute; BP: 100/60 mm Hg; P: 120 beats/minute; icterus +, Abdomen: soft, nontender, no spleen felt. Laboratory Test Results: LFTs: normal aspartate aminotransferase (AST) and alanine aminotransferase (ALT); total bilirubin 8 mg/dL, direct bilirubin 0.8 mg/dL.CBC: Hb-6.0%, Haptoglobin: decreased, Reticulocyte count: 8%,Coombs test: positive IgG warm antibody,Peripheral Smear: no schistocytes; no fragmented cells; spherocytes are seen.What is likely cause of her presentation?", "options": [{"label": "A", "text": "Hereditary spherocytosis", "correct": false}, {"label": "B", "text": "Malaria", "correct": false}, {"label": "C", "text": "Viral Hepatitis", "correct": false}, {"label": "D", "text": "Autoimmune hemolytic anemia", "correct": true}], "correct_answer": "D. Autoimmune hemolytic anemia", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/58883331698817961/58883331698817961.m3u8"}, {"text": "A 40 year old male patient presented with anemia preceded by intake of ampicillin for sore throat. Lab investigations revealed- Hb:6.5%, reticulocyte count 4%,and coombs test positive.A diagnosis of drug induced autoimmune hemolytic anemia is made. Methylprednisolone and folic acid are started. After transfusion of two units of packed RBCs is given hb remains low. What should you do to increase the hb?", "options": [{"label": "A", "text": "Splenectomy", "correct": false}, {"label": "B", "text": "Start IVIG.", "correct": true}, {"label": "C", "text": "Add dexamethasone to methylprednisolone.", "correct": false}, {"label": "D", "text": "Perform plasmapheresis.", "correct": false}], "correct_answer": "B. Start IVIG.", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/73975691698817986/73975691698817986.m3u8"}, {"text": "A 23-year-old man comes to the emergency department with complaints of a few hours of dark urine and fatigue. He had been having a cough with sputum and fever for the past 2 days. His condition suddenly got worse after his temperature went up early today. He has not started any new medications recently. On examination- respiratory rate: 25 breaths/minute; BP: 110/70 mm Hg; P: 105 beats/minute; Temperature: 101Â°F.Chest: rales at right base, Abdomen: nontender liver Neurological: normal, icterus +. Laboratory Test Results: CBC:Hb-8.0%, ; MCV 90 fL; WBC and platelet counts normal, coombâ€™s test is negative. Chest x-ray: right lower lobe infiltrate LFTs: total bilirubin 6.8 mg/dL; direct bilirubin1.2 mg/dL; LDH elevated, AST and ALT normal, Urine Analysis: dipstick positive for blood, but no RBCs seen, Oximeter: 92% on room air.What is the most likely cause of this anemia", "options": [{"label": "A", "text": "Autoimmune hemolytic anemia", "correct": false}, {"label": "B", "text": "PNH", "correct": true}, {"label": "C", "text": "Hereditary spherocytosis", "correct": false}, {"label": "D", "text": "G6PD deficiency", "correct": false}], "correct_answer": "B. PNH", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/35066191698817998/35066191698817998.m3u8"}, {"text": "A 20 year old male was diagnosed as having malaria and was given primaquine. On third of primaquine patient c/o fatique, weakness and dyspnea. Physical examination-icterus +,abdomen, respiratory system and cardiovascular system are normal. Lab results showed-Hb 9.0%,reticulocyte count 4%,high indirect bilirubin. You are suspecting G6PD deficiency. Which of the following should be tested first to find G6PD deficiency?", "options": [{"label": "A", "text": "G6PD level", "correct": false}, {"label": "B", "text": "Complement levels", "correct": false}, {"label": "C", "text": "Brilliant cresyl blue stain for Heinz bodies", "correct": true}, {"label": "D", "text": "Genetic studies", "correct": false}], "correct_answer": "C. Brilliant cresyl blue stain for Heinz bodies", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/48617261698818015/48617261698818015.m3u8"}, {"text": "Patient presented to emergency and diagnosed as a case of G6PD deficiency induced hemolysis after taking antibiotics for urinary tract infection. Supportive treatment with IV fluids was started. He insisted on getting the CBC done again to see improvement. The follow-up CBC the next day shows no significant change in Hb and hematocrit. What is the treatment?", "options": [{"label": "A", "text": "Continue Supportive therapy", "correct": true}, {"label": "B", "text": "Steroids", "correct": false}, {"label": "C", "text": "Intravenous G6PD", "correct": false}, {"label": "D", "text": "IVIGs", "correct": false}], "correct_answer": "A. Continue Supportive therapy", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/26900941698818051/26900941698818051.m3u8"}, {"text": "A 24-year-old man with intermittent episodes of dark urine in the morning comes to your OPD. He has been feeling weak and tired for months. He gets short of breath when he is walking up stairs and is easily fatigued. He does not have a fever and has not had any infections in the past. Past medical history: thrombosis of portal vein 2 years ago treated with 6 months of warfarin Present Medications: none, On examination Respiratory rate: 16 breaths/minute; BP: 120/80 mm Hg; P: 70 beats/minutes; T: 98Â°F. Pallor +,icterus +,CVS, respiratory system and Neurological: normal findings. Reports: CBC:Hb-8.9 g/dl, WBCs 2,900/Î¼L (low); platelets 80,000/Î¼L (low), Urine Analysis: dipstick positive for hemoglobin ,Serum potassium 5.5 mEq /L;serum indirect bilirubin 4.2 mg/dL (elevated); LDH elevated. Smear: schistocytes, fragmented cells,Reticulocytes: 14%, Haptoglobin: decreased Coombs test: negative.What is the likely cause of this presentation", "options": [{"label": "A", "text": "Paroxysmal Nocturnal hemoglobinuria", "correct": true}, {"label": "B", "text": "Autoimmune hemolytic anemia", "correct": false}, {"label": "C", "text": "G6PD deficiency", "correct": false}, {"label": "D", "text": "Hereditary spherocytosis", "correct": false}], "correct_answer": "A. Paroxysmal Nocturnal hemoglobinuria", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/30868291698818070/30868291698818070.m3u8"}, {"text": "A 20 year old male presented with c/o dark urine in early morning with clearing in day time. He has h/o pulmonary embolism due to renal vein thrombosis 2 years back. Lab results shows- Hb 6.7%,undetectable serum haptoglobin, low WBC, low platelets. What is the most accurate test to establish a diagnosis of the patient disease process?", "options": [{"label": "A", "text": "Sugar water (sucrose hemolysis) test", "correct": false}, {"label": "B", "text": "CD55 and CD59 by flow cytometry", "correct": true}, {"label": "C", "text": "Ham test", "correct": false}, {"label": "D", "text": "Complement levels", "correct": false}], "correct_answer": "B. CD55 and CD59 by flow cytometry", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/59339211698818091/59339211698818091.m3u8"}, {"text": "A 13-year-old boy with a recent diarrheal episode for 5 days presented to emergency department by parents with complaint of dark urine and fatigue developed over the last day. He has been febrile. There is some blood in the stool. His skin has been yellow. BP: 90/50 mm Hg; Pulse: 122 beats/minute; T: 101Â°F. Abdomen: mild diffuse tenderness, Chest: clear, Neurological: normal examination: serum creatinine 1.9 mg/dL, CBC:hb-7.0 g/dl; platelets 38,000/Î¼L UA: hemoglobin present; no bilirubin. Chest x-ray: normal Liver: serum total bilirubin 5 mg/dL, indirect bilirubin 4 mg/dl; LDH elevated. What is the most appropriate next step for this patient?", "options": [{"label": "A", "text": "Supportive treatment and observe.", "correct": true}, {"label": "B", "text": "Start ciprofloxacin.", "correct": false}, {"label": "C", "text": "Give platelet transfusion", "correct": false}, {"label": "D", "text": "IV steroids", "correct": false}], "correct_answer": "A. Supportive treatment and observe.", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/68097371698818117/68097371698818117.m3u8"}, {"text": "A 40 year old male presented with 3 days history of fever, decreased urine output and confusion. On examination facial puffiness is present, CNS-patient disoriented but no focal neurological deficit, no neck rigidity. Laboratory test results:Hb-8.8%,reticulocyte count 5%,:creatinine 2.4 mg/dL CBC: Hb- 8.4 g/dl, platelets 34,000/Î¼L. Peripheral smear done is shown in the figure. Coombs test is negative, aPPT-normal. What will be most appropriate line of treatment", "options": [{"label": "A", "text": "IV steroids", "correct": false}, {"label": "B", "text": "Antibiotics", "correct": false}, {"label": "C", "text": "Platelet transfusion", "correct": false}, {"label": "D", "text": "Plasmapheresis", "correct": true}], "correct_answer": "D. Plasmapheresis", "question_images": ["https://d2enu63wt1sf3u.cloudfront.net/ckfinder/files/20(115).jpg"], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/11317341705127779/11317341705127779.m3u8"}, {"text": "A 30-year-old woman with epistaxis for the past few days visits in emergency department. The patient says she has a long history of bleeding episodes. Her menstrual periods are heavy at times. Previous OPD papers mentioned that she has ITP. On examination- Skin: petechiae on both lower extremities. CBC: platelet count 25,000/?L PT, aPTT, INR: all normal. One hour later the patientâ€™s bleeding worsens. There is melena, more petechiae, and haematuria. A repeat CBC shows platelet level at 9000/ÂµL. Which is the fastest way to raise the platelet count in idiopathic thrombocytopenic purpura ?", "options": [{"label": "A", "text": "Romiplostim or eltrombopag", "correct": false}, {"label": "B", "text": "Dexamethasone", "correct": false}, {"label": "C", "text": "Platelet transfusion", "correct": false}, {"label": "D", "text": "IVIG", "correct": true}], "correct_answer": "D. IVIG", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/1637711698818163/1637711698818163.m3u8"}, {"text": "A 21-year-old woman presented with abnormal bleeding after a minor cut while working in kitchen. She was taking aspirin for a headache for 3 days. The skin kept oozing blood for more than 2 days. She gave past medical history of prolonged bleeding after dental extraction. On examination- Skin: bleeding from skin cut, petechiae of lower extremities. Vitals-stable. CBC: Hb 12.2 g/dl,; WBCs 7000/Î¼L; platelets 245,000/Î¼L (normal) PT: 11 seconds (normal) aPTT: 66 seconds (abnormally prolonged) Chemistry and LFTs: normal. What is the likely cause of her bleeding", "options": [{"label": "A", "text": "Hemophilia A", "correct": false}, {"label": "B", "text": "Hemophilia B", "correct": false}, {"label": "C", "text": "ITP", "correct": false}, {"label": "D", "text": "vWD", "correct": true}], "correct_answer": "D. vWD", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/25621701698818180/25621701698818180.m3u8"}, {"text": "A 25 year old male diagnosed as a case of type 1 vWD. The vWF antigen level is low. The ristocetin cofactor activity level is markedly impaired. The patient needs her wisdom teeth removed. You are planning to give desmopressin (DDAVP) prior to the procedure. What is the mechanism of DDAVP?", "options": [{"label": "A", "text": "Increased production of vWF", "correct": false}, {"label": "B", "text": "Increased expression of vWF receptors", "correct": false}, {"label": "C", "text": "Inhibition of ADAMTS 13", "correct": false}, {"label": "D", "text": "Release of subendothelial stores of vWF and factor VIII", "correct": true}], "correct_answer": "D. Release of subendothelial stores of vWF and factor VIII", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/77985111698818193/77985111698818193.m3u8"}, {"text": "In previous case DDAVP is given and the dental extraction is performed. Bleeding persists and a subsequent dose of DDAVP is ineffective. At this point, what medication should you use?", "options": [{"label": "A", "text": "Aminocaproic acid", "correct": false}, {"label": "B", "text": "Factor VIII replacement", "correct": true}, {"label": "C", "text": "Protamine sulfate", "correct": false}, {"label": "D", "text": "Steroids", "correct": false}], "correct_answer": "B. Factor VIII replacement", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/57800161698818204/57800161698818204.m3u8"}, {"text": "A 54-year-old woman comes with an elevated aPTT that her surgeon found prior to a planned lumpectomy for breast cancer. Needle biopsy showed infiltrating ductal carcinoma. Bleeding was not excessive at the time of the biopsy. Laboratory Test Results: CBC and LFTs: normal ,PT and INR: normal, aPTT: prolonged to 60 seconds. The mixing study shows a normalization of aPTT. Which coagulation factor abnormality is most likely in the patient", "options": [{"label": "A", "text": "Factor VIII deficiency", "correct": false}, {"label": "B", "text": "Factor IX deficiency", "correct": false}, {"label": "C", "text": "Factor XI deficiency", "correct": true}, {"label": "D", "text": "Factor XI inhibitor", "correct": false}], "correct_answer": "C. Factor XI deficiency", "question_images": [], "explanation_images": [], "explanation": "<p>@dams_new_robot</p>", "bot": "@dams_new_robot", "video": "https://d2enu63wt1sf3u.cloudfront.net/dqb_vod/25601731698818215/25601731698818215.m3u8"}];
            if (!Array.isArray(questions) || questions.length === 0) {
                throw new Error("Questions data is empty or invalid");
            }
            debugLog(`Successfully parsed ${questions.length} questions`);
        } catch (e) {
            console.error("Failed to parse questions_json:", e);
            document.getElementById(